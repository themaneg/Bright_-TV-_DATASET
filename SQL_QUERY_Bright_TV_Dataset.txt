SELECT
    -- 1. Viewership by Location (Province)
    T2.Province,
    COUNT(T1.UserID) AS TotalSessions,
    COUNT(DISTINCT T1.UserID) AS DistinctViewers,
    
    -- 2. User by Race and Gender
    T2.Race,
    COUNT(CASE WHEN T2.Gender = 'male' THEN 1 END) AS MaleUsers,
    COUNT(CASE WHEN T2.Gender = 'female' THEN 1 END) AS FemaleUsers,
    COUNT(T2.UserID) AS TotalUsers,
    
    -- 3. Viewership by Race and Gender
    T2.Gender,
    ROUND(CAST(COUNT(T1.UserID) AS DOUBLE) * 100 / (SELECT COUNT(*) FROM Viewership), 2) AS SessionPercentage,
    
    -- 4. Usage Consumption by Age Cohort
    CASE
        WHEN T2.Age BETWEEN 0 AND 17 THEN 'Kids (0-17)'
        WHEN T2.Age BETWEEN 18 AND 24 THEN 'Youth (18-24)'
        WHEN T2.Age BETWEEN 25 AND 34 THEN 'Adult (25-34)'
        WHEN T2.Age BETWEEN 35 AND 44 THEN 'Mature Adult (35-44)'
        WHEN T2.Age BETWEEN 45 AND 54 THEN 'Middle-Aged Adult (45-54)'
        WHEN T2.Age >= 55 THEN 'Retired (55+)'
        ELSE 'Not Specified'
    END AS AgeCohort,
    
    -- 5. Daily Viewership (SA Time)
    DAYOFWEEK(from_utc_timestamp(to_timestamp(T1.RecordDate2, 'yyyy/MM/dd HH:mm'), 'Africa/Johannesburg')) AS DayOfWeek,
    DATE(from_utc_timestamp(to_timestamp(T1.RecordDate2, 'yyyy/MM/dd HH:mm'), 'Africa/Johannesburg')) AS SessionDate_SA,
    -- 6. Time with Most Views (SA Time)
    HOUR(from_utc_timestamp(to_timestamp(T1.RecordDate2, 'yyyy/MM/dd HH:mm'), 'Africa/Johannesburg')) AS HourOfDay,
    -- 7. Top 10 Successful Content
    T1.Channel2 AS Channel,
    SUM(T1.`Duration 2`) AS TotalDurationInSeconds,
    -- Additional: Session Start Time (SA Time)
    from_utc_timestamp(to_timestamp(T1.RecordDate2, 'yyyy/MM/dd HH:mm'), 'Africa/Johannesburg') AS SessionStartTime_SA,
    -- Additional: User Email for presentation
    T2.Email,
    -- Additional: Social Media Handle
    T2.`Social Media Handle`
FROM
    Viewership AS T1
INNER JOIN
    User_Profile AS T2 ON T1.UserID = T2.UserID
GROUP BY
    T2.Province,
    T2.Race,
    T2.Gender,
    CASE
        WHEN T2.Age BETWEEN 0 AND 17 THEN 'Kids (0-17)'
        WHEN T2.Age BETWEEN 18 AND 24 THEN 'Youth (18-24)'
        WHEN T2.Age BETWEEN 25 AND 34 THEN 'Adult (25-34)'
        WHEN T2.Age BETWEEN 35 AND 44 THEN 'Mature Adult (35-44)'
        WHEN T2.Age BETWEEN 45 AND 54 THEN 'Middle-Aged Adult (45-54)'
        WHEN T2.Age >= 55 THEN 'Retired (55+)'
        ELSE 'Not Specified'
    END,
    DAYOFWEEK(from_utc_timestamp(to_timestamp(T1.RecordDate2, 'yyyy/MM/dd HH:mm'), 'Africa/Johannesburg')),
    DATE(from_utc_timestamp(to_timestamp(T1.RecordDate2, 'yyyy/MM/dd HH:mm'), 'Africa/Johannesburg')),
    HOUR(from_utc_timestamp(to_timestamp(T1.RecordDate2, 'yyyy/MM/dd HH:mm'), 'Africa/Johannesburg')),
    T1.Channel2,
    from_utc_timestamp(to_timestamp(T1.RecordDate2, 'yyyy/MM/dd HH:mm'), 'Africa/Johannesburg'),
    T2.Email,
    T2.`Social Media Handle`
ORDER BY
    TotalSessions DESC,
    TotalUsers DESC;